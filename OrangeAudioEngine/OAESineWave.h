#pragma once

//////////////////////////////////////////////////////////////////////////
/// Includes
//////////////////////////////////////////////////////////////////////////

#include <OAEProceduralSource.h>


//////////////////////////////////////////////////////////////////////////
/// COAESineWave
//////////////////////////////////////////////////////////////////////////

class COAESineWave : public IOAEProceduralSource
{
public:

	//////////////////////////////////////////////////////////////////////////

	COAESineWave( const OASourceId& aSourceId );
	~COAESineWave();

	//////////////////////////////////////////////////////////////////////////

	bool Initialize() override;

	//////////////////////////////////////////////////////////////////////////

	bool PopulateAudioBuffer( XAUDIO2_BUFFER* anAudioBuffer, OAUInt32 aBytesToRead, OAUInt32& aBytesRead, OAUInt32 aByteOffset /* = 0 */ ) override;


private:

	//////////////////////////////////////////////////////////////////////////

	void PopulateByteBuffer( XAUDIO2_BUFFER* anAudioBuffer, OAUInt32 aSampleCount );
	void PopulateShortBuffer( XAUDIO2_BUFFER* anAudioBuffer, OAUInt32 aSampleCount );

	//////////////////////////////////////////////////////////////////////////

	OAFloat32 m_currentTime;
	OAFloat32 m_deltaTime;
	OAFloat32 m_frequency;

	OAUInt32  m_sampleRate;
	OAUInt16  m_channelCount;
	OAUInt16  m_bytesPerChannel;
	OAUInt16  m_power;
};
